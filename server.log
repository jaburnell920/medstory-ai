
> medstory-ai@0.1.0 dev
> next dev --turbopack --port 12000 --hostname 0.0.0.0

   â–² Next.js 15.3.3 (Turbopack)
   - Local:        http://localhost:12000
   - Network:      http://0.0.0.0:12000

 âœ“ Starting...
 âœ“ Compiled middleware in 247ms
 âœ“ Ready in 1162ms
 âš  Webpack is configured while Turbopack is not, which may cause problems.
 âš  See instructions if you need to configure Turbopack:
  https://nextjs.org/docs/app/api-reference/next-config-js/turbo

 â—‹ Compiling /story-flow-map/tension-resolution ...
 âœ“ Compiled /story-flow-map/tension-resolution in 2.6s
 GET /story-flow-map/tension-resolution 200 in 2903ms
 âš  Cross origin request detected from work-1-bzkqcmrmydwjutaw.prod-runtime.all-hands.dev to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 â—‹ Compiling /api/tension-resolution ...
 âœ“ Compiled /api/tension-resolution in 879ms
 POST /api/tension-resolution 200 in 954ms
API Route - User message: move on to creating tension-resolution points
API Route - Conversation history length: 8
Move on condition triggered
 POST /api/tension-resolution 200 in 25ms
API Route - User message: short
API Route - Conversation history length: 10
Short narrative condition triggered
 POST /api/tension-resolution 200 in 26ms
API Route - User message: yes
API Route - Conversation history length: 12
Table condition triggered!
User message: yes
Conversation history: [
  {
    role: 'assistant',
    content: 'Do you want to use the currently selected Core Story Concept or provide a new one?'
  },
  { role: 'user', content: 'Use the currently selected one' },
  {
    role: 'assistant',
    content: 'No saved Core Story Concept found. Please create a new one.'
  },
  {
    role: 'user',
    content: 'Lisinopril remains a cornerstone in hypertension management, offering unparalleled efficacy, safety, and renal protection that newer drugs cannot match.'
  },
  { role: 'assistant', content: 'Who is your audience?' },
  { role: 'user', content: 'Cardiologists' },
  {
    role: 'assistant',
    content: 'Would you like to modify this Attack Point, create a new one, or move on to creating tension-resolution points?'
  },
  {
    role: 'user',
    content: 'move on to creating tension-resolution points'
  },
  {
    role: 'assistant',
    content: 'Would you like a short narrative (3-5 tension-resolution points), full narrative (8-12 tension-resolution points), or would you like to specify the number of tension-resolution points?'
  },
  { role: 'user', content: 'short' },
  {
    role: 'assistant',
    content: 'Would you like the tension-resolution points put into a table format?'
  },
  { role: 'user', content: 'yes' }
]
 POST /api/tension-resolution 200 in 26ms
 â—‹ Compiling / ...
 âœ“ Compiled / in 840ms
 GET / 200 in 901ms
 âœ“ Compiled in 142ms
 GET /story-flow-map/tension-resolution 200 in 230ms
 POST /api/tension-resolution 200 in 90ms
 POST /api/tension-resolution 200 in 25ms
 POST /api/tension-resolution 200 in 25ms
 POST /api/tension-resolution 200 in 28ms
 âœ“ Compiled in 139ms
 GET / 200 in 52ms
 GET / 200 in 54ms
 GET / 200 in 51ms
 GET / 200 in 46ms
API Route Debug:
- User message: yes
- Conversation history length: 12
- Last assistant message: yes
TABLE CONDITION TRIGGERED!
- User said yes: true
- Found table in history: true
 POST /api/tension-resolution 200 in 71ms
 âœ“ Compiled in 140ms
 âœ“ Compiled in 145ms
 GET /story-flow-map/tension-resolution 200 in 262ms
 POST /api/tension-resolution 200 in 25ms
API Route Debug:
- User message: move on
- Conversation history length: 8
- Last assistant message: move on
 POST /api/tension-resolution 200 in 30ms
API Route Debug:
- User message: short
- Conversation history length: 10
- Last assistant message: short
 POST /api/tension-resolution 200 in 25ms
API Route Debug:
- User message: yes
- Conversation history length: 12
- Last assistant message: yes
TABLE CONDITION TRIGGERED!
- User said yes: true
- Found table in history: true
 POST /api/tension-resolution 200 in 28ms
 âœ“ Compiled in 137ms
 âœ“ Compiled in 140ms
 GET / 200 in 51ms
 POST /api/tension-resolution 200 in 80ms
ðŸŽ¯ TABLE CONDITION TRIGGERED!
- User message: yes
- User said yes: true
- Conversation history: [
  {
    "role": "assistant",
    "content": "Do you want to use the currently selected Core Story Concept or provide a new one?\n\nCurrently selected: Core Story Concept Candidate #1\n\nTENSION:\n\nIn the unceasing barrage of hypertension treatments, why would a cardiologist who desires reliable, physiologically harmonious solutions reach for lisinopril? Amidst the roar of the latest drug innovations, the subtle yet profound value of lisinopril as an ACE inhibitor often gets scaled down, overlooked. For many, the mechanistic role of ACE inhibitors' vasodilating and renal protective properties is sidelined for their blood pressure reduction merit.\n\nRESOLUTION:\n\nLisinopril excellently repurposes angiotensin I from being a predecessor of the hypertensive culpritâ€”angiotensin IIâ€”to being itself a counter to hypertension. It not only dilates blood vessels to reduce blood pressure but also minimizes harmful proteinuria and fibrosis in the long-standing hypertensive state. Unveil the overlooked capacity of lisinoprilâ€”it's not just an ACE inhibitor, but a pressure modulator and renal protector, operating in a trio of pivotal roles. The unmet need is not in the latest drugâ€”it's lisinopril, an old faithful, undisputed in its efficacy, unchallenged in its safety, and peer-reviewed for its unwavering loyalty to ACE-inhibition."
  },
  {
    "role": "user",
    "content": "use current"
  },
  {
    "role": "assistant",
    "content": "Who is your audience?"
  },
  {
    "role": "user",
    "content": "cardiologists"
  },
  {
    "role": "assistant",
    "content": "Would you like to modify this Attack Point, create a new one, or move on to creating tension-resolution points?"
  },
  {
    "role": "user",
    "content": "move on"
  },
  {
    "role": "assistant",
    "content": "Would you like a short narrative with 3-5 tension-resolution points, a full narrative with 8-12 tension-resolution points, or would you like to specify a different number of tension-resolution points?"
  },
  {
    "role": "user",
    "content": "short"
  },
  {
    "role": "assistant",
    "content": "Would you like me to put the tension-resolution points into a table?"
  },
  {
    "role": "user",
    "content": "yes"
  }
]
- Found table in history: true
 POST /api/tension-resolution 200 in 85ms
ðŸŽ¯ TABLE CONDITION TRIGGERED!
- User message: yes
- User said yes: true
- Last assistant message: Would you like me to put the tension-resolution points into a table?
- Contains table question: true
âœ… Showing table format
 POST /api/tension-resolution 200 in 78ms
